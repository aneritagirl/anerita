<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>MYQER — MVP Offline/Online Hybrid QR</title>
  <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>
  <meta http-equiv="Content-Security-Policy"
      content="default-src 'self';
               img-src 'self' data:;
               style-src 'self' 'unsafe-inline';
               script-src 'self' 'unsafe-inline'">
</head>
<body style="font-family:Arial,sans-serif; text-align:center; padding:2rem;">

  <h1>MYQER — Hybrid QR Demo</h1>
  <canvas id="qr"></canvas>

  <script>
    // Hardcoded user profile (demo)
    const profile = {
      name: "Anita Boros",
      dob: "1988-10-13",
      country: "GB",
      blood: "O+",
      allergies: "Penicillin, Codeine, Midazolam",
      conditions: "Alport Syndrome",
      donor: "Y",
      url: "https://myqer.com/c/6P6NH6"  // short code URL
    };

    // Build hybrid payload (plain text + URL last)
    const payload = `
Name: ${profile.name}
DOB: ${profile.dob}
Country: ${profile.country}
BT: ${profile.blood}
ALG: ${profile.allergies}
COND: ${profile.conditions}
DONOR: ${profile.donor}
URL: ${profile.url}
    `.trim();

    // Draw QR
    QRCode.toCanvas(
      document.getElementById("qr"),
      payload,
      { width: 260, margin: 2, errorCorrectionLevel: 'H' },
      function (err) {
        if (err) console.error(err);
        else console.log("✅ QR generated:", payload);
      }
    );
  </script>

</body>
</html>
