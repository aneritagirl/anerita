<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>MYQER — Hybrid QR Demo</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    body{font-family:Arial,Helvetica,sans-serif;padding:24px}
    h1{margin:0 0 16px;text-align:center}
    .wrap{max-width:760px;margin:0 auto}
    .qrrow{display:flex;gap:24px;align-items:flex-start;flex-wrap:wrap}
    .box{border:1px solid #e5e7eb;padding:16px;border-radius:8px}
    .qr{width:360px;height:360px}
    .controls{margin-top:12px}
    input[type=text]{width:100%;padding:10px;border:1px solid #d1d5db;border-radius:6px;font-family:ui-monospace,Consolas,monospace}
    button{padding:10px 14px;border:1px solid #111;border-radius:6px;background:#111;color:#fff;cursor:pointer}
    small{color:#666}
    svg{shape-rendering:crispEdges}
  </style>
</head>
<body>
<div class="wrap">
  <h1>MYQER — Hybrid QR Demo</h1>

  <div class="qrrow">
    <div class="box">
      <h3>Hybrid QR (URL + text)</h3>
      <div id="qrHybrid" class="qr" aria-label="Hybrid QR"></div>
      <div class="controls">
        <input id="urlOut" type="text" readonly />
        <div style="margin-top:8px"><button id="openBtn">Open link</button></div>
        <small>Tip: scan with your phone Camera app. You should see a banner for the URL.</small>
      </div>
    </div>

    <div class="box">
      <h3>URL-only QR (control)</h3>
      <div id="qrUrlOnly" class="qr" aria-label="URL-only QR"></div>
      <small>If this one shows the banner but the hybrid doesn’t, the issue is size/clarity.</small>
    </div>
  </div>
</div>

<<script>
/* your data */
const profile = {
  name:"Anita Boros",
  dob:"1988-10-13",
  country:"GB",
  blood:"O+",
  allergies:"Penicillin, Codeine, Midazolam",
  conditions:"Alport Syndrome",
  donor:"Y",
  url:"https://myqer.com/c/6P6NH6"
};

/* 1) URL first, then text (camera banner likes this) */
const hybridPayload =
`${profile.url}

Name: ${profile.name}
DOB: ${profile.dob}
Country: ${profile.country}
BT: ${profile.blood}
ALG: ${profile.allergies}
COND: ${profile.conditions}
DONOR: ${profile.donor}`.trim();

/* 2) URL-only control */
const urlOnlyPayload = profile.url;

/* helper → make SVG with proper ECC and auto version */
function makeSvgQR(text, ecc='Q', margin=4, cellSize=4) {
  // version 0 = auto; ecc = 'L','M','Q','H'
  const qr = qrcode(0, ecc);
  qr.addData(text);
  qr.make();
  // createSvgTag lets us control margin & module size
  return qr.createSvgTag({ cellSize, margin });
}

/* render (use slightly larger module size for the hybrid because payload is longer) */
document.getElementById('qrHybrid').innerHTML  = makeSvgQR(hybridPayload, 'Q', 4, 5);
document.getElementById('qrUrlOnly').innerHTML = makeSvgQR(urlOnlyPayload, 'Q', 4, 5);
document.getElementById('urlOut').value = profile.url;

/* open link button */
document.getElementById('openBtn').onclick = () => window.open(profile.url, '_blank', 'noopener');
</script>
</body>
</html>
